<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DIGIPAN — Keluarga</title>
<link href="static/img/logo/2.png" rel="icon">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
  :root {
   --brand: #34acb0;
   --brands: #ffc107;
    --brand-light: #34acb0;
    --brand-dark: #5ce1e6;
    --bg: #f4f8fa;
    --card: #ffffff;
    --text: #1a202c;
    --muted: #4a5568;
    --accent: #0000;
    --white: #fff;
    --radius: 8px;
    --shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
    --shadow-hover: 0 10px 20px rgba(0, 0, 0, 0.12);
  }

  * { box-sizing: border-box; margin:0; padding:0; }
  body { 
    background: var(--bg); 
    color: var(--text); 
    line-height: 1.6;
    font-family: 'Poppins', sans-serif;
    transition: background-color 0.3s;
  }
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap');
  a { text-decoration: none; color: var(--brand); }
  h1, h2, h3 { color: var(--text); font-weight: 700; }
header {
  background: var(--brand);
  color: #fff;
  padding: 10px 20px;
  box-shadow: 0 01px 8px rgba(0,0,0,0.2);
  z-index: 100;
  position: sticky;
  top: 0;
  transition: background 0.3s ease, backdrop-filter 0.3s ease;
}
/* Saat di-scroll: efek transparan + ubah warna teks & ikon */
header.scrolled {
  background: rgba(255, 255, 255, 0.1); /* semi-transparan */
  backdrop-filter: blur(10px);
  box-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

/* Ubah warna teks dan logo di dalam header */
/* Hanya ubah logo dan hamburger */
header.scrolled .logo {
  color: var(--brand) !important;
}

/* Tetap jaga warna menu tetap putih */
header.scrolled nav ul li a {
    color: #34acb0 !important;
}

/* Tapi saat hover, boleh sedikit transparan */
header.scrolled nav ul li a:hover {
  background: rgba(255, 255, 255, 0.15);
}

/* Hamburger berubah jadi warna brand */
header.scrolled .hamburger div {
  background: var(--brand);
}


  .nav-container { display: flex; justify-content: space-between; align-items: center; max-width: 1300px; margin:auto;}
  .logo { font-size: 1.8rem; font-weight: 800; color: #fff; letter-spacing: 1px;}
  nav ul { display: flex; gap: 30px; list-style: none;}
  nav ul li { position: relative; }
  nav ul li a { 
    color: white; 
    text-decoration: none; 
    font-weight: 600; 
    padding: 10px 15px; 
    display: block; 
    border-radius: 6px;
    transition: background-color 0.2s, transform 0.2s;
  }
  nav ul li:hover > a { background: var(--brand-light); transform: translateY(-1px); }
  
  nav ul li ul { 
    display: none; 
    position: absolute; 
    top: 50px;
    left:0; 
    background: var(--brand-dark); 
    border-radius: var(--radius); 
    min-width: 200px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.3);
    z-index: 10;
    padding: 8px 0;
  }
  nav ul li:hover ul { display:block; }
  nav ul li ul li a { 
    color: #fff;
    padding: 10px 20px; 
    font-weight: 500;
  }
  nav ul li ul li a:hover {
    background: var(--brand);
  }

  .hamburger {
    display: none;
    flex-direction: column;
    gap:6px;
    color: white;
    cursor: pointer;
    padding: 8px;
  }
  .hamburger div {
    width: 30px;
    height:3px;
    background:white;
    border-radius:2px;
    transition: all 0.3s;
  }

  main { 
    max-width: 1300px; 
    margin: 0 auto; 
    padding:0 20px; /* Hapus padding-top */
  }
  
  /* Jarak antar Section */
  #layanan, #laporan, #informasi, #tutorial {
      margin-top: 60px;
  }

  h2 { 
    font-size: 2rem; 
    margin-bottom: 30px; 
    color: var(--brand-dark);
    text-align: center;
    position: relative;
    padding-bottom: 15px;
    margin-top: 0; /* Hapus margin-top di sini, gunakan pada #layanan */
  }
  h2::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 4px;
    background: var(--accent);
    border-radius: 2px;
  }

  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 30px;
  }
  
  /* --- Perubahan pada Card Layanan --- */
  .card { 
    background: var(--card); 
    border-radius: var(--radius); 
    box-shadow: var(--shadow); 
    transition: all 0.3s;
    overflow: hidden; 
    display: flex; 
    flex-direction: column;
  }
  .card:hover {
    box-shadow: var(--shadow-hover);
  }
  
  .card-content {
    padding: 30px 30px 20px;
    flex-grow: 1; 
  }

  .card h3 { 
    margin-bottom: 15px; 
    display: flex;
    align-items: center;
    font-size: 1.4rem;
    font-weight: 600;
  }
  .card h3 i {
    color: var(--brand);
    margin-right: 15px;
    font-size: 1.8rem;
  }
  
  .card p, .card li { color: var(--muted); font-size: 1.05rem;}
  .card ul { list-style: none; padding-left: 0;}
  .card li { 
    margin-bottom: 10px;
    border-left: 3px solid var(--brand-light);
    padding-left: 10px;
  }

  /* Gaya untuk Action Link pada Layanan Utama */
  .card-action {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 15px 30px;
    background-color: var(--brand); 
    color: white;
    text-align: center;
    font-weight: 600;
    transition: background-color 0.2s, transform 0.2s;
    border-top: 1px solid var(--brand-light);
  }
  .card-action:hover {
    background-color: var(--brand-dark);
    transform: translateY(0); 
  }
  .card-action i {
    margin-right: 10px;
    color: white; 
    font-size: 1.1rem;
  }

  footer { 
    text-align:center; 
    padding: 40px 20px; 
    background: var(--brand-light); 
    color: #ffff; 
    margin-top: 80px;
    font-size: 1rem;
  }
  footer a { color: var(--text); text-decoration: none; transition: color 0.2s;}
  footer a:hover { color: #000;}

  /* --- HERO SLIDER: FULL-WIDTH --- */
  .hero-slider {
      position: relative;
      width: 100%;
      margin: 0; 
      overflow: hidden;
      box-shadow: var(--shadow-hover);
  }

  .slides {
      position: relative;
      width: 100%;
      height: 350px;
  }

  .slide {
      position: absolute; 
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      transition: opacity 0.8s ease-in-out;
      z-index: 1; 
  }

  .slide.active {
      opacity: 1;
      z-index: 2;
  }

  .slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  /* --- DOT NAVIGATIONS --- */
  .slider-dots {
      text-align: center;
      padding: 10px 0;
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
      margin-top: 0; 
  }

  .dot {
      height: 8px;
      width: 8px;
      margin: 0 4px;
      background-color: #bbb;
      border-radius: 50%;
      display: inline-block;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s, border-color 0.3s;
      border: 2px solid #bbb;
  }

  .dot.active {
      background-color: var(--brand); 
      border-color: var(--brand);
      transform: scale(1.2);
  }

  /* --- CAPTION DI BAWAH SLIDER (PERBAIKAN UKURAN H1) --- */
  .slider-captions {
    text-align: center; 
    max-width: 800px; 
    margin: 0 auto 60px; /* Jarak yang cukup di bawah caption */
    padding: 0 20px;
  }

  .slider-captions .caption {
      position: relative;
      padding: 0;
      background: none; 
      color: var(--text); 
      display: none; 
      transition: opacity 0.3s ease-in-out;
      text-align: center;
      z-index: 1;
  }

  .slider-captions .caption.active {
      display: block; 
  }

 .slider-captions .caption h2 { /* Catatan: Saya ubah dari h1 ke h2 karena di HTML Anda menggunakan h2 */
      color: var(--brand-dark); 
      /* PERBAIKAN: Mengurangi ukuran H1, max 2.5rem (desktop) dan 1.6rem (mobile) */
      font-size: clamp(1.5rem, 3vw, 2rem); /* Ukuran disesuaikan agar lebih besar */
      margin-bottom: 5px; /* <--- Diubah menjadi 5px untuk jarak yang sangat tipis */
      font-weight: 800;
      text-shadow: none; 
  }

  .slider-captions .caption p {
      color: var(--muted); 
      font-size: clamp(1rem, 1.5vw, 1.4rem);
      max-width: 700px;
      font-weight: 400;
      text-shadow: none; 
      margin: 0 auto;
  }
  
  .info-panel {
    display: flex;
    align-items: flex-start;
    gap: 16px;
    background: #f0faff;
    padding: 20px;
    border-radius: 14px;
    box-shadow: 0 2px 12px rgba(2, 8, 23, 0.08);
    margin: 60px auto 60px;
    transition: transform 0.2s;
    max-width: 1300px;
    
  }
  .info-panel:hover {
    transform: translateY(-3px);
  }
  .info-icon i {
    font-size: 36px;
  }
  .info-content h3 {
    margin: 0 0 8px 0;
    font-size: 20px;
  }
  .info-content p {
    margin: 0;
    color: #475569;
  }


  @media(max-width:900px){
    .hamburger.open div:nth-child(1) { transform: rotate(-45deg) translate(-6px, 6px); }
    .hamburger.open div:nth-child(2) { opacity: 0; }
    .hamburger.open div:nth-child(3) { transform: rotate(45deg) translate(-6px, -6px); }

    nav ul { 
      display: none; 
      flex-direction: column; 
      background: var(--brand); 
      position: absolute; 
      top: 65px; 
      right: 20px; 
      border-radius: var(--radius); 
      overflow: hidden; 
      width: 280px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.2);
      padding: 10px 0;
      gap: 0;
      z-index: 110; 
    }
    nav ul.show { display:flex; }
    .hamburger { display:flex; }
    nav ul li a { padding: 14px 25px; border-radius: 0; }
    nav ul li:hover > a { background: var(--brand-dark); transform: none; }
    
    nav ul li ul {
      position: static;
      background: var(--brand-dark);
      box-shadow: none;
      border-radius: 0;
      padding: 0;
      width: 100%;
      margin-top: 0;
    }
    nav ul li ul li a:hover { background: var(--brand-light); }

    .card-grid {
      grid-template-columns: 1fr;
    }
    h2 {
      font-size: 1.5rem;
    }
    
    /* Penyesuaian Mobile untuk Slider */
    .hero-slider {
        margin: 0;
    }
    .slides {
        height: 250px; 
    }
    .slider-captions .caption h1 {
        font-size: 1.6rem;
    }
    .slider-captions .caption p {
        font-size: 1.1rem;
    }
    main { 
        padding-top: 0;
    }
    header.scrolled nav ul li a {
    color: white !important;
    
  }
  header.scrolled nav ul li a i {
    color: white !important;
    
  }
}
  /* === FORM CONTAINER === */
.form-section {
    max-width: 640px;
    margin: 40px auto;
    padding: 0 20px;
}
.form-container {
    padding: 40px;
    background: var(--card);
    border-radius: var(--radius);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    border-top: 5px solid var(--brand);
    display: flex;
    flex-direction: column;
    gap: 25px; /* sebelumnya 15px → lebih lega antar kelompok elemen */
}



/* === FORM TITLE === */
.form-container h1 {
    font-size: 1.8rem;
    color: var(--brand);
    text-align: center;
    margin-bottom: 25px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--brand-light);
    font-weight: 800;
}

/* === FORM GROUP === */

.form-group {
    display: flex;
    flex-direction: column;
    gap: 10px; /* jarak label ke input */
    margin-bottom: 20px; /* tambahkan margin antar field */
}

.form-group label {
    font-weight: 600;
    color: var(--text);
    font-size: 1rem;
}

/* === INPUTS & SELECT === */
.form-group input[type="text"],
.form-group input[type="date"],
.form-group select {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #e2e8f0;
    border-radius: var(--radius);
    font-size: 1rem;
    color: var(--text);
    background-color: var(--bg);
    transition: border-color 0.2s, box-shadow 0.2s;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
}

.form-group input:focus,
.form-group select:focus {
    border-color: var(--brand-dark);
    box-shadow: 0 0 0 3px rgba(52, 172, 176, 0.2);
    outline: none;
}

/* === NOTE TEXT === */
.note {
    margin-top: 3px;
    font-size: 0.9rem;
    color: var(--muted);
}

/* === SUBMIT BUTTON === */
.submit-btn {
    width: 100%;
    padding: 15px;
    background-color: var(--brand);
    color: var(--white);
    border: none;
    border-radius: var(--radius);
    font-size: 1.2rem;
    font-weight: 700;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.1s;
    margin-top: 15px;
}

.submit-btn:hover {
    background-color: var(--brand-dark);
    transform: translateY(-1px);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

.submit-btn i {
    margin-right: 8px;
}

/* === RESPONSIVE DESIGN === */
@media (max-width: 900px) {
    .form-section {
        margin: 40px auto;
        padding: 0 15px;
    }

    .form-container {
        padding: 25px 20px;
    }

    .form-container h1 {
        font-size: 1.6rem;
        margin-bottom: 20px;
    }

    .form-group label {
        font-size: 0.95rem;
    }

    .form-group input[type="text"],
    .form-group input[type="date"],
    .form-group select {
        padding: 10px;
        font-size: 0.95rem;
    }

    .submit-btn {
        padding: 12px;
        font-size: 1.1rem;
    }
}

</style>
</head>
<body>

<header>
  <div class="nav-container">
    <div class="logo">DigiWarga</div>
    <nav>
      <div class="hamburger" onclick="toggleMenu()">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <ul id="navMenu">
         <li><a href="/main"><i class="fas fa-home"></i> Beranda</a></li>
        <li><a href="/main#layanan"><i class="fas fa-tools"></i> Layanan Utama</a></li>
        <li>
          <a href="/main#laporan"><i class="fas fa-file-invoice-dollar"></i> Laporan Keuangan ▾</a>
          <ul>
            <li><a href="/main#pemasukan">Pemasukan</a></li>
            <li><a href="/main#pengeluaran">Pengeluaran</a></li>
          </ul>
        </li>
         <li><a href="/main#informasi"><i class="fas fa-info-circle"></i> Informasi</a></li>
        <li><a href="/main#tutorial"><i class="fas fa-book"></i> Tutorial</a></li>
        <li><a href="/logoutuser" ><i class="fas fa-sign-out-alt"></i> Keluar</a></li>
      </ul>
    </nav>
  </div>
</header>
<main>
    <section id="input-keluarga" class="form-section">
        <div class="card form-container">
            <h1>Formulir Data Keluarga</h1>
            <form id="family-form" action="{{ url_for('input_data') }}" method="POST">
                <div class="form-group">
                    <label for="nama_keluarga">Nama Keluarga:</label>
                    <input type="text" id="nama_keluarga" name="nama_keluarga" placeholder="*contoh : Keluarga Sitompul" style="text-transform: uppercase;" required>
                    <small class="note">*Catatan: Nama Keluarga harus sama untuk setiap anggota keluarga</small>
                </div>
                <div id="error-message" style="display: none; color: red;"></div>

                <div class="form-group">
                    <label for="nama">Nama Lengkap:</label>
                    <input type="text" id="nama" name="nama" placeholder="*contoh : Joko Widodo" required>
                </div>
                <div class="form-group">
                    <label for="tempat_lahir">Tempat Lahir:</label>
                    <input type="text" id="tempat_lahir" name="tempat_lahir" placeholder="*contoh : Bogor" required>
                </div>
                <div class="form-group">
                    <label for="tanggal_lahir">Tanggal Lahir:</label>
                    <input type="date" id="tanggal_lahir" name="tanggal_lahir" onclick="this.showPicker();" onkeydown="return false;" required>
                </div>
                <div class="form-group">
                    <label for="nomor_keluarga">Nomor yang dapat dihubungi:</label>
                    <input type="text" id="nomor_keluarga" name="nomor_keluarga" pattern="\d*" placeholder="*contoh : 0899992999" required>
                </div>
                <div class="form-group">
                    <label for="hubungan_keluarga">Hubungan Keluarga:</label>
                    <select id="hubungan_keluarga" name="hubungan_keluarga" required>
                        <option value="" disabled selected>Pilih Hubungan</option>
                        <option value="Kepala Keluarga">Kepala Keluarga</option>
                        <option value="Istri">Istri</option>
                        <option value="Anak">Anak</option>
                    </select>
                </div>    
                <button type="submit" class="submit-btn"><i class="fas fa-paper-plane"></i> Kirim Data</button>
            </form>
        </div>
    </section>

</main>
<footer>
  <p>© <span id="year"></span> Digipan | all right reserved</a>.</p>
</footer>

<script>
    document.getElementById("year").innerText = new Date().getFullYear();

  function toggleMenu(){
    const navMenu = document.getElementById("navMenu");
    const hamburger = document.querySelector(".hamburger");
    navMenu.classList.toggle("show");
    hamburger.classList.toggle("open");
  }

// --- FUNGSI BARU: Mengirim Formulir sebagai JSON dengan Loading Minimal 3 Detik ---
document.getElementById('family-form').addEventListener('submit', function(e) {
    e.preventDefault();

    const form = e.target;
    const formData = new FormData(form);
    const jsonData = {};
    
    formData.forEach((value, key) => {
        jsonData[key] = value;
    });
    
    const startTime = Date.now(); // Catat waktu mulai

    // Tampilkan SweetAlert Loading
    Swal.fire({
        title: 'Mengirim Data...',
        text: 'Mohon tunggu sebentar, data sedang diproses.',
        icon: 'info',
        allowOutsideClick: false,
        showConfirmButton: false,
        didOpen: () => {
            Swal.showLoading()
        }
    });

    // 2. Kirim data menggunakan Fetch API
    fetch(form.action, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json' 
        },
        body: JSON.stringify(jsonData)
    })
    .then(response => {
        // Cek jika respons tidak OK
        if (!response.ok) {
            return response.json().then(err => Promise.reject(err.error || 'Gagal mengirim data.'));
        }
        return response.json();
    })
    .then(data => {
        const endTime = Date.now();
        const elapsedTime = endTime - startTime;
        const minimumTime = 3000; // 3 detik

        // Tunggu hingga minimal 3 detik tercapai
        const delay = Math.max(0, minimumTime - elapsedTime);

        setTimeout(() => {
            Swal.close(); // Tutup loading
            // Tampilkan notifikasi sukses
            Swal.fire({
                title: 'Berhasil! ',
                text: data.message,
                icon: 'success',
                timer: 2500,
                showConfirmButton: false
            }).then(() => {
                form.reset(); // Kosongkan formulir
            });
        }, delay);
    })
    .catch(error => {
        const endTime = Date.now();
        const elapsedTime = endTime - startTime;
        const minimumTime = 3000; // 3 detik
        const delay = Math.max(0, minimumTime - elapsedTime);

        setTimeout(() => {
            Swal.close(); // Tutup loading
            // Tampilkan notifikasi error
            Swal.fire({
                title: 'Gagal!',
                text: typeof error === 'string' ? error : 'Terjadi kesalahan saat memproses data.',
                icon: 'error',
                confirmButtonText: 'Tutup'
            });
        }, delay);
    });
});
// -------------------------------------------------------------------

function logoutUser() {
    fetch("/logout")
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                Swal.fire({
                    title: 'Berhasil Keluar!',
                    text: data.message,
                    icon: 'success',
                    timer: 2000,
                    timerProgressBar: true,
                    showConfirmButton: false,
                    background: '#f9f9f9',
                    color: '#333',
                    customClass: {
                        popup: 'rounded-2xl shadow-lg',
                    },
                    didClose: () => {
                        window.location.href = data.redirect;
                    }
                });
            } else {
                Swal.fire({
                    title: 'Gagal Logout',
                    text: 'Terjadi kesalahan, silakan coba lagi.',
                    icon: 'error',
                    confirmButtonText: 'Tutup'
                });
            }
        })
        .catch(error => {
            console.error("Logout error:", error);
            Swal.fire({
                title: 'Kesalahan!',
                text: 'Terjadi error saat logout.',
                icon: 'error',
                confirmButtonText: 'Tutup'
            });
        });
}

  document.addEventListener('click', function(e){
    const menu = document.getElementById("navMenu");
    const hamburger = document.querySelector(".hamburger");
    if(menu.classList.contains('show') && !menu.contains(e.target) && !hamburger.contains(e.target)){
      menu.classList.remove("show");
      hamburger.classList.remove("open");
    }
  });
  document.querySelectorAll('i[data-color]').forEach(icon => {
  icon.style.color = icon.dataset.color;
});

window.addEventListener("scroll", function() {
    const header = document.querySelector("header");
    if (window.scrollY > 50) {
      header.classList.add("scrolled");
    } else {
      header.classList.remove("scrolled");
    }
  });
</script>
<script src="https://kit.fontawesome.com/your-own-kit.js" crossorigin="anonymous" async></script>
</body>
</html>